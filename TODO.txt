TODO
  - Extract out the common code to make it easier to add ORMs